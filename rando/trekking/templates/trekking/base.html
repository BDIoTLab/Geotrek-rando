{% load i18n static leaflet_tags compress trekking ganalytics %}
<!DOCTYPE html>
<html>
<head>
    <!-- VERSION : {{ VERSION }} -->
    {% block head %}
    <title>{% block title %}{{ TITLE }}{% endblock title %}</title>
    <link rel="shortcut icon" href="{% static "ico/favicon.ico" %}">
    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
        <script src="{% static "js/html5.js" %}"pt>
    <![endif]-->
    {% compress css %}
    {% leaflet_css %}
    <link href="{% static "css/bootstrap.css" %}" rel="stylesheet">
    <link href="{% static "css/bootstrap-responsive.css" %}" rel="stylesheet">
    <link type="text/css" href="{% static "js/jscrollpane/jquery.jscrollpane.css" %}" rel="stylesheet" media="all" />
    <link rel="stylesheet" href="{% static "css/jquery-ui.css" %}" />
    <link rel="stylesheet" href="{% static "css/chosen.css" %}" />
    <link rel="stylesheet" href="{% static "css/style.css" %}" />
    <link rel="stylesheet" href="{{ MEDIA_URL }}style.css" />
    {% endcompress %}
    {% endblock head %}

    {% block extrahead %}
    {% endblock extrahead %}
</head>
<body>
  <div id="top-panel" class="navbar navbar-fixed-top">
    <div class="navbar-inner">
      <div class="container">
        <div class="nav-collapse">
          <a href="{% url trekking:home %}"><h3>{{ TITLE }}</h3></a>
        </div>
      </div>

      <a class="btn" id="global-share" href="#">{% trans "Share" %}</a> </div>

      <div id="search-bar">
        <a id="show-filters" href="#" class="show-hide-filters"></a> 
        <a id="hide-filters" href="#" class="show-hide-filters" style="display: none"></a>

        <p class="title">{% trans "Filters" %}</p>

        <div id="basic-filters">
          <div class="stage">
            <label>{% trans "Difficulty" %}</label>
            <div class="slider-wrap">
              <div id="stage" data-filter="stage"></div>
            </div>
            <div class="slider-value first">{% trans "Easy" %}</div>
            <div class="slider-value">{% trans "Medium" %}</div>
            <div class="slider-value last">{% trans "Hard" %}</div>
          </div>
          <div class="time">
            <label>{% trans "Duration" %}</label>
            <div class="slider-wrap">
              <div id="time" data-filter="time"></div>
            </div>
            <div class="slider-value first">{% trans "Short" %}</div>
            <div class="slider-value">1/2</div>
            <div class="slider-value">{% trans "day" %}</div>
            <div class="slider-value">{% trans "2 days" %}</div>
            <div class="slider-value last">&gt;{% trans "2 days" %}</div>
          </div>
          <div class="den">
            <label>{% trans "Climb" %}</label>
            <div class="slider-wrap">
              <div id="den" data-filter="den"></div>
            </div>
            <div class="slider-value first">&lt; 200m</div>
            <div class="slider-value">200-700m</div>
            <div class="slider-value">700-1000m</div>
            <div class="slider-value last">&gt;1000m</div>
          </div>

          <div class="theme">
            <label>{% trans "Thematic" %}</label>
            {% for theme in themes %}
              <div class="filter" data-filter="theme" data-id="{{ theme.id }}" id="theme-{{ theme.id }}">
                {{ theme|pictogram }}
                <p>{{ theme.label }}</p>
            </div>
            {% endfor %}
          </div>
        </div>

        <div id="advanced-filters" style="display: none">

          <div class="filter-bloc usage">
            <select id="usage" tabindex="2" multiple="" data-filter="usage" data-placeholder="{% trans "Usages" %}">
            {% for usage in usages %}
              <option data-filter="usage" data-id="{{ usage.id }}" value="{{ usage.id }}">{{ usage.label }}</option>
            {% endfor %}
            </select>
          </div>

          <div class="filter-bloc vallee">
            <select id="district" tabindex="2" multiple="" data-filter="district" data-placeholder="{% trans "Valleys" %}">
            {% for district in districts %}
              <option data-filter="district" data-id="{{ district.id }}" value="{{ district.id }}">{{ district.name }}</option>
            {% endfor %}
            </select>
          </div>

          <div class="filter-bloc cities">
            <select id="city" tabindex="2" multiple="" data-filter="city" data-placeholder="{% trans "Cities" %}">
            {% for city in cities %}
              <option data-filter="city" data-id="{{ city.code }}" value="{{ city.code|safe }}">{{ city.name }}</option>
            {% endfor %}
            </select>
          </div>

          <div class="filter-bloc route">
            <select id="route" tabindex="2" multiple="" data-filter="route"  data-placeholder="{% trans "Route" %}">
            {% for route in routes %}
              <option data-filter="route" data-id="{{ route.id }}" value="{{ route.id|safe }}">{{ route.label }}</option>
            {% endfor %}
            </select>
          </div>

        </div>
        <!--  advanced-filters-->

      </div>
      <!--  search-bar-->
    </div>
    <!--  navbar-inner-->
  </div>
  <!-- navbar-->

  <div class="container" id="container-content">

    <div id="mainmap"></div>

    <div id="content">
        {% block content %}
        {% endblock content %}
    </div>

  </div>
  <!-- container -->

  <footer id="bottom-panel" class="footer">
    {% fileinclude "footer.html" %}
  </footer>

  {% compress js %}
  <script src="{% static "js/jquery.min.js" %}" type="text/javascript"></script>
  <script src="{% static "js/jquery-ui.js" %}"></script>
  <script src="{% static "js/jquery.sparkline.min.js" %}"></script>
  <script src="{% static "js/jscrollpane/jquery.jscrollpane.min.js" %}" type="text/javascript"></script>
  <script src="{% static "js/jscrollpane/jquery.mousewheel.js" %}"></script>
  <script src="{% static "js/jquery.pjax.js" %}"></script>
  {% leaflet_js %}
  <script type="text/javascript">
    L.Icon.Default.imagePath = '{% static "leaflet/images" %}';
  </script>
  <script src="{% static "js/bootstrap.min.js" %}"></script>
  <script src="{% static "js/leaflet-objectslayer.js" %}"></script>
  <script src="{% static "js/rtree.js" %}"></script>
  <script src="{% static "js/chosen.jquery.min.js" %}"></script>

  <script src="{% static "js/application/ui.js" %}"></script>
  <script src="{% static "js/application/filter.js" %}"></script>
  <script src="{% static "js/application/backpack.js" %}"></script> 
  <script src="{% static "js/application/map.js" %}"></script> 
  {% endcompress %}

  {% ganalytics %}

  <script type="text/javascript">

      /*
       * A bunch of globals \o/
       */
      var trekFilter = null,
          backPack = null,
          treksLayer = null,
          treks = {{ treksjson|safe }};

      $(document).ready(function (e) {
          init_ui();
          page_load();
      });

      $(document).on('pjax:end', function (e) {
          page_load();
          // Try a custom lazy load
          var mainmapContainer = L.DomUtil.get('mainmap');
          if (mainmapContainer && typeof(loadmapmainmap) == "function") {
              if (!mainmapContainer._leaflet) loadmapmainmap();
          }
          var detailmapContainer = L.DomUtil.get('detailmap');
          if (detailmapContainer && typeof(loadmapdetailmap) == "function") {
              if (!detailmapContainer._leaflet) loadmapdetailmap();
          }
      });
  </script>

</body>
</html>
