{% load static leaflet_tags %}
<!DOCTYPE html>
<html>
<head>
    {% block head %}
    <title>{% block title %}{{ settings.title }}{% endblock title %}</title>
    {% leaflet_js %}
    {% leaflet_css %}
    {% endblock head %}
    {% block extrahead %}
    {% endblock extrahead %}
</head>
<body>
    <div id="mainmap"></div>
    <div id="content">
        {% block content %}
        {% endblock content %}
    </div>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery-sparklines/2.0.0/jquery.sparkline.min.js"></script>
    <script src="{% static "js/jquery.pjax.js" %}"></script>
    <script type="text/javascript">
        $(document).ready(function (e) {
            $('#content').pjax('a.pjax');
        });
        $(document).on('pjax:end', function (e) {
            // Try a custom lazy load
            var mainmapContainer = L.DomUtil.get('mainmap');
            if (loadmapmainmap) {
                if (!mainmapContainer._leaflet) loadmapmainmap();
            }
            var detailmapContainer = L.DomUtil.get('detailmap');
            if (detailmapContainer && loadmapdetailmap) {
                if (!detailmapContainer._leaflet) loadmapdetailmap();
            }
            
            if ($("#mainmap-tag").length > 0)
                $("#mainmap").show();
            else
                $("#mainmap").hide();
        });
    </script>
</body>
</html>
